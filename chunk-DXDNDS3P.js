import{a as V,b as W}from"./chunk-HHLC7LFI.js";import{a as E}from"./chunk-NO5EP2EX.js";import{a as x,b as L,c as R}from"./chunk-YP6RHCKT.js";import{m as z}from"./chunk-XTBGYHB6.js";import{B as C,Ga as i,H as k,Ha as T,I as D,Ia as m,Ma as U,Na as j,U as w,X as a,Y as d,fa as h,fb as F,gb as M,h as v,i as O,ib as $,j as S,ka as p,kb as A,m as _,p as y,r as b,ra as r,sa as t,ta as I,tb as N,wa as P,ya as f,za as g}from"./chunk-4ABEXS3U.js";function H(s,l){if(s&1&&(r(0,"p",21)(1,"span",22),i(2,"Size :"),t(),i(3),t()),s&2){let c=g().$implicit;a(3),m(" ",c.Size," ")}}function J(s,l){if(s&1){let c=P();r(0,"div",15),f("click",function(){let e=k(c).$implicit,o=g(2);return D(o.navigateToDetails(e))}),r(1,"div",16),I(2,"img",17),t(),r(3,"div",18)(4,"h2",19),i(5),t(),h(6,H,4,1,"p",20),r(7,"p",21)(8,"span",22),i(9,"Quantity :"),t(),i(10),t(),r(11,"p",21)(12,"span",22),i(13,"Status :"),t(),i(14),t(),r(15,"p",21)(16,"span",22),i(17,"Payment Method :"),t(),i(18),t(),r(19,"div",23)(20,"div",24)(21,"p",25),i(22),t()()()()()}if(s&2){let c=l.$implicit,n=g().$implicit;a(2),p("src",c.image,w)("alt",c.title),a(3),T(c.title),a(),p("ngIf",c.Size),a(4),m(" ",c.quantity," "),a(4),m(" ",n.status," "),a(4),m(" ",n.paymentMethod," "),a(4),m(" Total : ",c.totalPrice," ")}}function Q(s,l){if(s&1&&(r(0,"div"),h(1,J,23,8,"div",14),t()),s&2){let c=l.$implicit;a(),p("ngForOf",c.productsData)}}function B(s,l){s&1&&(r(0,"p",26),i(1," No Orders "),r(2,"span",27),i(3,"Please Make Order"),t()())}var de=(()=>{let l=class l{constructor(n,e,o,u,Y,G,q){this.cartService=n,this.wishlistService=e,this.router=o,this.http=u,this.authService=Y,this.toastrService=G,this.spinner=q,this.myOrders=[],this.apiUrlUser=x.userApiUrl,this.apiUrlOrder=x.ordersApiUrl}ngOnInit(){let n=sessionStorage.getItem("loggedInUser");n&&(this.userData=JSON.parse(n),this.spinner.show(),this.fetchMyOrders(this.userData.id).subscribe({next:e=>{this.myOrders=e,this.spinner.hide()},error:e=>{console.error("Error fetching user orders:",e),this.spinner.hide(),this.toastrService.showInfo("Some Problem fetching user orders","Try again")}}))}setCartOpen(){this.cartService.openCart()}setWishlistOpen(){this.wishlistService.openWishlist()}navigateToDetails(n){let e=n.id.substring(n.id.lastIndexOf("/")+1);this.router.navigate(["/products",e])}fetchMyOrders(n){return this.http.get(`${this.apiUrlUser}/${n}`).pipe(y(3),S(e=>e.myOrders||[]),b(e=>e.length>0?this.fetchAllOrderDetails(e):v([])),_(e=>(this.toastrService.showInfo("Some Problem fetching user orders","Try again"),O(e))))}fetchAllOrderDetails(n){return v(n).pipe(b(e=>Promise.all(e.map(o=>this.fetchOrderDetails(o)))),S(e=>e.filter(o=>o!==null)))}fetchOrderDetails(n){return this.http.get(`${this.apiUrlOrder}/${n}`).pipe(y(3),_(e=>(this.toastrService.showInfo("Some Problem fetching order details","Try again"),console.error("Error fetching order details:",e),v(null)))).toPromise()}logout(){this.toastrService.showSuccess("You have been logged out successfully","Success"),google.accounts.id.disableAutoSelect(),this.authService.logout(),this.router.navigate(["/login"])}};l.\u0275fac=function(e){return new(e||l)(d(V),d(W),d(N),d(A),d(L),d(z),d(R))},l.\u0275cmp=C({type:l,selectors:[["app-user-profile"]],standalone:!0,features:[U([{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,providers:[{id:E.PROVIDER_ID,provider:new E(x.GOOGLE_CLIENT_ID)}]}}]),j],decls:27,vars:5,consts:[[1,"container"],[1,"flex","justify-center","items-start","gap-2","p-4","border-b","font-primaryFont","image-container"],[1,"profile-pic"],["alt","",1,"rounded-full",3,"src"],[1,"flex","flex-col","justify-center","items-start","gap-2","detail-container"],[1,"flex","flex-wrap","justify-start","items-center","gap-2","btn-container"],[1,"flex","justify-center","items-center","gap-2","bg-black","hover:bg-primary","p-2","rounded-md","font-primaryFont","font-semibold","text-[12px]","text-white","tracking-wider",3,"click"],[1,"flex","justify-center","items-center","gap-2","bg-red-500","hover:bg-red-600","p-2","rounded-md","font-primaryFont","font-semibold","text-[12px]","text-white","tracking-wider",3,"click"],[1,"myorder-container","pt-2","container"],[1,"p-2","border-b","font-bold","font-secondaryFont","text-center"],[1,"cart-item-container","overflow-y-scroll"],[1,"p-4","cart-card-container"],[4,"ngFor","ngForOf"],["class","font-bold text-center text-red-500 tracking-wider",4,"ngIf"],["class","flex justify-start items-start gap-2 py-2 border-b w-full cursor-pointer cart-card",3,"click",4,"ngFor","ngForOf"],[1,"flex","justify-start","items-start","gap-2","py-2","border-b","w-full","cursor-pointer","cart-card",3,"click"],[1,"border-2","p-2","w-[25%]","md:w-[20%]","xl:w-[15%]","image-container"],[3,"src","alt"],[1,"relative","flex","flex-col","justify-start","items-start","space-y-2","pt-2","w-[70%]","font-primaryFont","text-sm","detail-container"],[1,"mb-1","tracking-wider"],["class","text-xs md:text-lg",4,"ngIf"],[1,"text-xs","md:text-lg"],[1,"font-semibold"],[1,"relative","flex","justify-between","items-center","w-full","quantity-total-container"],[1,"w-full","font-primaryFont","total-container"],[1,"font-semibold","text-xs","md:text-lg","capitalize","tracking-widest"],[1,"font-bold","text-center","text-red-500","tracking-wider"],[1,"text-blue-500","underline"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),I(3,"img",3),t(),r(4,"div",4)(5,"h1")(6,"b"),i(7,"Name:"),t(),i(8),t(),r(9,"h3")(10,"b"),i(11,"Email:"),t(),i(12),t(),r(13,"div",5)(14,"button",6),f("click",function(){return o.setCartOpen()}),i(15," MY CART "),t(),r(16,"button",6),f("click",function(){return o.setWishlistOpen()}),i(17," MY WISHLIST "),t(),r(18,"button",7),f("click",function(){return o.logout()}),i(19," Logout "),t()()()(),r(20,"div",8)(21,"h2",9),i(22," MY ORDERS "),t(),r(23,"div",10)(24,"div",11),h(25,Q,2,1,"div",12)(26,B,4,0,"p",13),t()()()()),e&2&&(a(3),p("src",o.userData.profilePic,w),a(5),m(" ",o.userData.name," "),a(4),m(" ",o.userData.email," "),a(13),p("ngForOf",o.myOrders),a(),p("ngIf",o.myOrders.length<=0))},dependencies:[$,F,M]});let s=l;return s})();export{de as UserProfileComponent};

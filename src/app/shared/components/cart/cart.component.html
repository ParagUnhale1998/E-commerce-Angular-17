<div id="cart" class="top-0 right-0 z-[99] fixed flex justify-center items-center w-screen h-screen">
    <div class="bg-gray-400 bg-opacity-50 shadow-md w-[30%] md:w-[50%] lg:w-[70%] h-full" (click)="closeCart()"></div>

    <div class="flex flex-col justify-start items-center bg-white shadow-md w-[70%] md:w-[50%] lg:w-[30%] h-full">
        <div class="flex justify-between items-center p-6 border-b w-full heading">
            <h3 class="font-primaryFont font-semibold text-lg uppercase tracking-wider">Cart</h3>
            <button class="ml-auto focus:outline-none" (click)="closeCart()">
                <!-- <span class="text-2xl text-gray-500 hover:text-gray-700">×</span> -->
                <i class="text-2xl text-iconcolor hover:text-black fa-solid fa-xmark"></i>
            </button>
        </div>
        <div  *ngIf="cartItems.length > 0" class="cart-item-container overflow-y-scroll">
            <div class="p-4 cart-card-container" >
                <div *ngFor="let product of cartItems; let index = index" (click)="navigateToProductPage(product)"
                    class="flex justify-between items-start gap-2 py-2 border-b w-full cart-card">
                    <div class="p-2 w-[25%] image-container">
                        <img [src]="product.featuredImage.url" [alt]="product.title" />
                    </div>
                    <div class="relative flex flex-col justify-start items-start pt-2 w-[70%] text-sm detail-container">
                        <div class="flex justify-between items-center mb-2 w-full heading-container">
                            <h2 class="tracking-wider">{{ product.title.split(' - ')[0] }}</h2>
                            <button class="ml-auto focus:outline-none" (click)="removeItemFromCart($event, index)">
                                <span class="text-2xl text-gray-500 hover:text-gray-700">×</span>
                            </button>
                        </div>
                        <p class="text-xs">
                            <!-- <span class="font-semibold">Color:</span> -->
                            <span class="font-semibold">Color:</span> {{ getProductColor(product) }}
                        </p>
                        <p class="text-xs">
                            <span class="font-semibold">Size:</span>
                            {{ product.selectedSize || 'None' }}
                        </p>
                        <p class="text-xs">
                            <span class="font-semibold">Quantity:</span>
                            {{ product.selectedQuantity }}
                        </p>
                        <div class="relative flex justify-between items-center mt-2 w-full quantity-total-container">
                            <div class="relative flex justify-center items-center border quantity-container">
                                <span class="hover:bg-black p-2 hover:text-white"
                                    (click)="handleQuantityChange($event,index, product.selectedQuantity - 1 > 0 ? product.selectedQuantity - 1 : 1, product)">
                                    -
                                </span>
                                <input type="text" [disabled]="true" [min]="1" [value]="product.selectedQuantity"
                                    class="bg-white w-5 text-center" placeholder="1" />
                                    <span class="hover:bg-black p-2 hover:text-white"
                                    (click)="handleQuantityChange($event,index, product.selectedQuantity + 1, product)">
                                  +
                              </span>
                              
                            </div>
                            <div class="text-right w-full font-secondaryFont total-container">
                                <span class="font-semibold capitalize tracking-widest">
                                    Rs. {{ (product.variants?.nodes?.[0]?.price?.amount || 0) * product.selectedQuantity }}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="cartItems.length <= 0" class="font-bold text-center text-red-500 tracking-wider">
            No Products <span class="text-blue-500 underline">Please Add Products</span>
        </div>
        <div *ngIf="cartItems.length > 0"
            class="flex flex-col justify-between items-center gap-4 p-6 w-full checkout-container">
            <div class="flex justify-between items-center w-full font-secondaryFont text-sm uppercase total-container">
                <span class="font-semibold">subtotal</span>
                <!-- <span class="font-bold capitalize">Rs. {{ cartTotalPrice }}</span> -->
                <span class="font-bold capitalize">Rs. {{ cartTotalPrice() }}</span> <!-- using singnal -->
            </div>
            <div class="flex flex-col justify-center items-center gap-2 order-btn-container font-primaryFont">
                <p class="text-[10px] text-center text-primary">
                    Shipping, taxes, and discount codes calculated at checkout.
                </p>
                <button (click)="navigateToCheckout()"
                    class="bg-black hover:bg-primary hover:shadow-md py-2 w-full font-semibold text-sm text-white uppercase tracking-wider">
                    place order
                </button>
            </div>
        </div>
    </div>
</div>